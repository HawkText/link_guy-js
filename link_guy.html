<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
    <style type="text/css">
        body{
            background-color: black;
            margin: 0px;
            font-size: 0;
        }


        div.row div{
            width:60px;
            height: 60px;
            display:inline-block;
        }
        
        div.stairs{
            background: url("images/downstairs.jpg");
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            width: 60px;
            height: 60px;
            

        }
        div.brick{
            background-color: blue;
        }

        div.empty{
            background-position: center;
        }

        div.leftwall{
            background: url("images/sprites_galore.png");
            background-position: -240px -315px;
            width: 60px;
            height: 60px;
            

        }
        
        div.purple_rupee{
            background: url("images/purple_rupee_spin.gif");
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
        }

        div#link_guy{
            background: url("images/link_walk_down.gif");
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            width: 60px;
            height: 60px;
            position: absolute;
        }

        div#score{
            border:1px solid white;
            width: 58px;
            height: 58px;
            color: rgb(161, 20, 32);
            background-color: rgb(161, 190, 29);
            font-size: 30px;
            outline-color: blue;
            position: absolute;
            top: 0px;
        }

        .bullet{
		background: url('images/1942.gif');
		background-position: -185px -400px;
		width:20px;
		height:20px;
		position:absolute;
        }

    </style>
    
    </head>
    <body>
        <div id="container">
            <div id='bullets'>
                <div class='bullet' style='top:250px; left:200px;'></div>
                <div class='bullet' style='top:350px; left:200px;'></div>
            </div>
            <div id="world"></div>
            <div id="world2"></div>
            <div id="link_guy"></div>
            <div id="score">Yum</div>
        </div>
        <script>

            var world = [
                [1,1,1,1,1,1,1,1,1,1,1,1,1],
                [10,0,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,5,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,1,1,1,1,1,1,1,1,1,1,1,1]
            ];

            var world2 = [
                [1,1,1,1,1,1,1,1,1,1,1,1,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,6,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,1,1,1,1,1,1,1,1,1,1,1,1]
            ];

            var world3 = [
                [1,1,1,1,1,1,1,1,1,1,1,1,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,2,2,2,2,2,2,2,2,2,2,2,1],
                [1,1,1,1,1,1,1,1,1,1,1,1,1]
            ];

            var score = 0;

            var link_guy = {
                x: 1,
                y: 1,
            };

            var bullets = [];

            function displayWorld(){
                var output ='';
                for(var i=0; i<world.length; i++){
                    output += "<div class='row'>";
                    for(var j=0; j<world[i].length; j++){
                        if(world[i][j] == 1)
                            output += "<div class='brick'></div>";
                        else  if(world[i][j] == 2)
                            output +="<div class='purple_rupee'></div>";
                        else if(world[i][j] == 5)
                            output += "<div class='stairs'></div>";
                        else if(world[i][j] == 6)
                            output += "<div class='stairs'></div>";
                        else if(world[i][j] == 0)
                            output +="<div class='empty'></div>";
                            else if(world[i][j] == 10)
                            output +="<div class='leftwall'></div>";
                    }
                    output +="\n</div>";
                }
                document.getElementById('world').innerHTML = output;
            }

            function displayLink_guy(){
                document.getElementById('link_guy').style.top = link_guy.y*60 + "px"
                document.getElementById('link_guy').style.left = link_guy.x*60 + "px"
            }
            function displayScore(){
                document.getElementById('score').innerHTML = score;
            }
            displayWorld();
            displayLink_guy();
            displayScore();
            
            function displayBullets(){
                var output = "";
		for (var i = 0; i<bullets.length; i++)
		{
			output += "<div class='bullet' style='top:"+ bullets[i].y + "px; left:"
					+bullets[i].x + "px;'></div>";
		}
		document.getElementById('bullets').innerHTML = output;
	}
            function moveBullets(){
		for (var i = 0; i<bullets.length; i++)
		{
			bullets[i].y -= 5;
			if (bullets[i].y <= 0)
			{
				removeItem(bullets, i);
			}
		}
	}
	function removeItem(arr, num)
	{
		for (var x = num; x < arr.length-1; x++)
		{
			arr[x] = arr[x+1];
		}
		arr.pop();
	}


    function gameLoop(){
                    displayScore();
                    moveBullets();
                    displayLink_guy();
                    displayBullets();
	}

	setInterval(gameLoop, 20);

            document.onkeydown = function(e){
                if(e.keyCode == 37 && world[link_guy.y][link_guy.x-1] != 1){
                    document.getElementById('link_guy').style.transform = "rotate(90deg)";
                    link_guy.x--;
                }
                else if(e.keyCode == 39 && world[link_guy.y][link_guy.x+1] != 1){
                    document.getElementById('link_guy').style.transform = "rotate(-90deg)";
                    link_guy.x++;
                }
                else if(e.keyCode == 38 && world[link_guy.y-1][link_guy.x] != 1){
                    document.getElementById('link_guy').style.transform = "rotate(-180deg)";
                    link_guy.y--;
                }
                else if(e.keyCode == 40 && world[link_guy.y+1][link_guy.x] != 1){
                    document.getElementById('link_guy').style.transform = "rotate(-360deg)";
                    link_guy.y++;
                }
                else if (e.keyCode == 32) {
                bullets.push({x: link_guy.x*60, y: link_guy.y*60});
            }
                if(world[link_guy.y][link_guy.x] == 5){
                    world.length = 0;                 
                    world.push.apply(world, world2);
                }
                if(world[link_guy.y][link_guy.x] == 6){
                    world.length = 0;                 
                    world.push.apply(world, world3);
                }
                if(world[link_guy.y][link_guy.x] == 2){
                    world[link_guy.y][link_guy.x] = 0;
                    score+=10;
                    displayWorld();
                    displayScore();
                }
            }
        </script>

    </body>
</html>